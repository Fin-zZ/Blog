<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>https http | chez的开发记录</title>
    <meta name="generator" content="VuePress 1.5.3">
    
    <meta name="description" content="Welcome to my Blog">
    <link rel="preload" href="/Blog/assets/css/0.styles.1fec798e.css" as="style"><link rel="preload" href="/Blog/assets/js/app.a1114f8c.js" as="script"><link rel="preload" href="/Blog/assets/js/2.866c5de6.js" as="script"><link rel="preload" href="/Blog/assets/js/9.f7629a86.js" as="script"><link rel="prefetch" href="/Blog/assets/js/10.534131b1.js"><link rel="prefetch" href="/Blog/assets/js/11.8a0ff58c.js"><link rel="prefetch" href="/Blog/assets/js/12.62bb3539.js"><link rel="prefetch" href="/Blog/assets/js/13.24ad2885.js"><link rel="prefetch" href="/Blog/assets/js/14.a4cb8862.js"><link rel="prefetch" href="/Blog/assets/js/15.f0281d56.js"><link rel="prefetch" href="/Blog/assets/js/16.567b138d.js"><link rel="prefetch" href="/Blog/assets/js/17.8bb7b935.js"><link rel="prefetch" href="/Blog/assets/js/18.15582be5.js"><link rel="prefetch" href="/Blog/assets/js/19.20a45bab.js"><link rel="prefetch" href="/Blog/assets/js/20.a631142b.js"><link rel="prefetch" href="/Blog/assets/js/21.d179aeae.js"><link rel="prefetch" href="/Blog/assets/js/22.8d87217d.js"><link rel="prefetch" href="/Blog/assets/js/23.b1aec37c.js"><link rel="prefetch" href="/Blog/assets/js/24.91a02c92.js"><link rel="prefetch" href="/Blog/assets/js/25.3606dbc3.js"><link rel="prefetch" href="/Blog/assets/js/26.3b089f70.js"><link rel="prefetch" href="/Blog/assets/js/27.4a3fb2ed.js"><link rel="prefetch" href="/Blog/assets/js/28.87f1c8b2.js"><link rel="prefetch" href="/Blog/assets/js/29.49265de6.js"><link rel="prefetch" href="/Blog/assets/js/3.216b12c9.js"><link rel="prefetch" href="/Blog/assets/js/30.4a3ce54c.js"><link rel="prefetch" href="/Blog/assets/js/31.d4a363dd.js"><link rel="prefetch" href="/Blog/assets/js/32.b253a6b3.js"><link rel="prefetch" href="/Blog/assets/js/33.ebdd7b3c.js"><link rel="prefetch" href="/Blog/assets/js/34.799332a8.js"><link rel="prefetch" href="/Blog/assets/js/35.f551ea2b.js"><link rel="prefetch" href="/Blog/assets/js/36.af10435b.js"><link rel="prefetch" href="/Blog/assets/js/37.8f18f6dd.js"><link rel="prefetch" href="/Blog/assets/js/38.d5ac6763.js"><link rel="prefetch" href="/Blog/assets/js/39.99b39a43.js"><link rel="prefetch" href="/Blog/assets/js/4.ecfd39ba.js"><link rel="prefetch" href="/Blog/assets/js/40.a79247e2.js"><link rel="prefetch" href="/Blog/assets/js/41.eb9bd787.js"><link rel="prefetch" href="/Blog/assets/js/42.45ea26f8.js"><link rel="prefetch" href="/Blog/assets/js/43.ab38f2a9.js"><link rel="prefetch" href="/Blog/assets/js/44.c503315a.js"><link rel="prefetch" href="/Blog/assets/js/45.3c0b116f.js"><link rel="prefetch" href="/Blog/assets/js/46.d24f5965.js"><link rel="prefetch" href="/Blog/assets/js/47.4f9bfe3b.js"><link rel="prefetch" href="/Blog/assets/js/48.b379ed93.js"><link rel="prefetch" href="/Blog/assets/js/49.537b00f6.js"><link rel="prefetch" href="/Blog/assets/js/5.e991952f.js"><link rel="prefetch" href="/Blog/assets/js/50.f63129ef.js"><link rel="prefetch" href="/Blog/assets/js/51.942a34d1.js"><link rel="prefetch" href="/Blog/assets/js/6.271bb3d3.js"><link rel="prefetch" href="/Blog/assets/js/7.7b0d089c.js"><link rel="prefetch" href="/Blog/assets/js/8.89817a60.js">
    <link rel="stylesheet" href="/Blog/assets/css/0.styles.1fec798e.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/Blog/" class="home-link router-link-active"><!----> <span class="site-name">chez的开发记录</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/Blog/css/flex.html" class="nav-link">
  HOME
</a></div><div class="nav-item"><a href="https://xdmatirx.github.io/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/Blog/css/flex.html" class="nav-link">
  HOME
</a></div><div class="nav-item"><a href="https://xdmatirx.github.io/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Css</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Git</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Js</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>Network</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/Blog/network/TCP_UDP.html" class="sidebar-link">TCP</a></li><li><a href="/Blog/network/https.html" aria-current="page" class="active sidebar-link">https http</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/Blog/network/https.html#使用https" class="sidebar-link">使用https</a></li></ul></li><li><a href="/Blog/network/网络安全.html" class="sidebar-link">web安全</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Practice More</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Webpack</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Wx Weapp</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>书籍类学习</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="https-http"><a href="#https-http" class="header-anchor">#</a> https http</h1> <p>http:超文本传输协议</p> <ol><li>http特点
<ul><li>灵活，可以传输任意类型对象，通过content-type定义</li> <li>无连接 每次连接只能处理一个请求，服务器处理完这次请求后，
并受到客户端回应后，就断开连接，不利于客户端和服务端会话的保持，
无法记录之前的状态，需要借助cookie session 记录用户</li> <li>无状态，指的是对事物处理没有记忆，后续如果要处理之前的信息，
则需要重传。</li></ul></li></ol> <p>缺点部分：</p> <ul><li><p>http是明文传播，涉及到密码、个人信息等就不太安全。
存在信息被篡改、被仿冒的可能。</p></li> <li><p>无状态，无法记录相关联信息</p></li></ul> <ol start="2"><li><p>URI: Uniform Resource Identifier 统一资源<em>标志</em>符
URL: Uniform Resource Location 统一资源<em>定位</em>符
URI: 具体描述某个资源的，可以通过URI知道该资源是什么，
URL：用来定位具体资源的位置，以及访问该资源的方式</p></li> <li><p>http报文组成</p></li></ol> <h4 id="请求报文"><a href="#请求报文" class="header-anchor">#</a> 请求报文</h4> <div class="language-http request extra-class"><pre class="language-http"><code><span class="token request-line"><span class="token property">POST</span> /api/v2/za/logs/batch HTTP/1.1</span>
<span class="token header-name keyword">Host:</span> zhihu-web-analytics.zhihu.com
<span class="token header-name keyword">Connection:</span> keep-alive
<span class="token header-name keyword">Content-Length:</span> 675
<span class="token header-name keyword">sec-ch-ua:</span> &quot; Not;A Brand&quot;;v=&quot;99&quot;, &quot;Google Chrome&quot;;v=&quot;91&quot;, &quot;Chromium&quot;;v=&quot;91&quot;
<span class="token header-name keyword">X-ZA-ClientID:</span> 35b5cc03-2b2d-4011-a794-3d51c1a12161
<span class="token header-name keyword">Content-Encoding:</span> gzip
<span class="token header-name keyword">sec-ch-ua-mobile:</span> ?0
<span class="token header-name keyword">User-Agent:</span> Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/91.0.4472.114 Safari/537.36
<span class="token header-name keyword">Content-Type:</span> application/x-protobuf
<span class="token header-name keyword">X-ZA-Product:</span> Zhihu
<span class="token header-name keyword">X-ZA-Batch-Size:</span> 6
<span class="token header-name keyword">X-ZA-Log-Version:</span> 3.1.51
<span class="token header-name keyword">X-ZA-Platform:</span> DesktopWeb
<span class="token header-name keyword">Accept:</span> */*
<span class="token header-name keyword">Origin:</span> https://zhuanlan.zhihu.com
<span class="token header-name keyword">Sec-Fetch-Site:</span> same-site
<span class="token header-name keyword">Sec-Fetch-Mode:</span> cors
<span class="token header-name keyword">Sec-Fetch-Dest:</span> empty
<span class="token header-name keyword">Referer:</span> https://zhuanlan.zhihu.com/p/72616216
<span class="token header-name keyword">Accept-Encoding:</span> gzip, deflate, br
<span class="token header-name keyword">Accept-Language:</span> zh-CN,zh;q=0.9,en;q=0.8
</code></pre></div><ol><li>请求方法 请求地址 协议/版本号</li> <li>请求头</li> <li>请求正文</li></ol> <h4 id="响应报文的结构"><a href="#响应报文的结构" class="header-anchor">#</a> 响应报文的结构</h4> <div class="language-http request extra-class"><pre class="language-http"><code><span class="token response-status">HTTP/1.1 <span class="token property">200 OK</span></span>
<span class="token header-name keyword">Date:</span> Tue, 20 Jul 2021 04:28:26 GMT
<span class="token header-name keyword">Content-Type:</span> text/html; charset=UTF-8
<span class="token header-name keyword">Content-Length:</span> 0
<span class="token header-name keyword">Connection:</span> keep-alive
<span class="token header-name keyword">Server:</span> openresty
<span class="token header-name keyword">Access-Control-Allow-Origin:</span> *
<span class="token header-name keyword">X-Backend-Response:</span> 0.003
</code></pre></div><ol><li>协议/版本号</li> <li>响应头</li> <li>响应报文</li></ol> <h3 id="post-get异同点"><a href="#post-get异同点" class="header-anchor">#</a> post get异同点</h3> <p>相同：</p> <ul><li>都有请求行，请求头</li> <li></li></ul> <p>不同：</p> <ul><li>get请求的参数都在url上，有长度上限制，该限制由各个浏览器决定。
post请求的参数可以在url上，但大多放到request body里，通过设置content-type类型，</li> <li>post相对来说稍微安全些，毕竟参数不在url上</li> <li>get请求具备等冥性，post不行；另外get请求的结果可被缓存下来。</li> <li>get 本质是检索远程数据的，请求通常是 获取资源，
并且不会对服务器数据进行修改； 具备等冥性
post通常用于发送表单数据，账号密码等，会更新数据库/插入数据，</li></ul> <p>响应的状态码
1XX：信息型 服务器收到请求，要求客户端继续的
2XX：成功型 请求收到，并成功返回；
3XX：重定向类型，永久、临时、使用缓存等；
4XX：客户端出差，无法访问等
5XX：服务器出错。</p> <p>常见的状态码：
200: ok 成功返回
301：永久重定向
302: 临时重定向
304: 资源未改变，使用缓存
400: bad request
403: forbidden
404: not found
503: 服务器暂时无法处理客户端请求.</p> <h2 id="使用https"><a href="#使用https" class="header-anchor">#</a> 使用https</h2> <p>https 一般认为是http + SSL/TLS协议
设计目标：</p> <ol><li>数据的加密，保证数据被加密，无法被第三方查看。</li> <li>数据的完整性，及时发现数据被第三方窜改过。</li> <li>身份的校验，确保数据是所希望的地址</li></ol> <p>相比于http的区别：</p> <ol><li>https需要使用ca证书验证身份，需要一定费用</li> <li>使用的默认端口不一样，https443，http8080</li> <li>http明文传输，https是加密信息的传输，相对安全
改进的地方
<ol><li>双向的身份认证</li> <li>数据加密</li></ol></li></ol> <p>缺点：</p> <ol><li>首次握手连接的消耗增加</li> <li>ca证书需要的费用</li> <li>数据加密以及解密带来的资源消耗</li> <li>也只是安全了一定程度，如果ca证书链并不安全呢</li></ol> <p>TLS协议使用了两种加密技术：对称加密和非对称加密
TLS协议位于应用层之下，传输层上。</p> <p>TLS利用非对称加密进行身份认证，密钥协商；对称加密进行信息加密以传输，基于散列函数验证数据的完整性。</p> <p>服务器可以将公钥发送给各个客户端，客户端直接直接无法解密，但可以利用该公钥进行数据加密，服务器拿到后再利用私钥解密，
即可实现一对多。问题的关键在于如何给客户端公钥。毕竟中途也可能如下图被拦截窜改。</p> <p><img src="/Blog/assets/img/TLS.24221658.png" alt="TLS">
图片来自 https://tyler-zx.blog.csdn.net/article/details/107591115</p> <p>解决方法之一是依靠中心化机构，有他们发布一些可信赖的证书，后续的认证下属证书
才有层次的签名架构，以此下去，一个证书可能会含有1or多个根证书。
一些知名的根证书通常随系统装好了</p> <h3 id="http1-1"><a href="#http1-1" class="header-anchor">#</a> http1.1</h3> <p>相比http1.0 解决了队首阻塞问题，
当http开启长连接时，共用一个tcp连接，那么一次也就只能处理
一个任务，存在阻塞问题。
解决方案：</p> <ul><li>多个并发连接，chrome允许同时存在6个</li> <li>利用多个子域名分散开请求。</li></ul> <p>针对浏览器跨域问题：
浏览器遵循同源策略，非同源站点存在一些限制</p> <ul><li>不可读取和修改对方站点的dom</li> <li>不可读取对方cookie，LocalStorage, IndexDB</li> <li>限制了XMLHTTPRequest请求。</li></ul> <p>当一个资源从与该资源本身所在的服务器<strong>不同的域、协议或端口</strong>请求一个资源时，资源会发起一个<strong>跨域 HTTP 请求</strong>。</p> <table><thead><tr><th>URI</th> <th></th> <th>changeOrigin</th></tr></thead> <tbody><tr><td>http://www.cnblogs.com/a.js  http://www.a.com/b.js</td> <td>不同域名</td> <td>是</td></tr> <tr><td>http://www.a.com/lab/a.js  http://www.a.com/script/b.js</td> <td>同域名下不同文件</td> <td>否</td></tr> <tr><td>http://www.a.com:8000/a.js  http://www.a.com/b.js</td> <td>不同端口（port）</td> <td>是</td></tr> <tr><td>http://www.a.com/a.js  https://www.a.com/b.js</td> <td>同域名 不同协议</td> <td>是</td></tr></tbody></table> <p>解决方法：</p> <ol><li>跨域资源共享(<a href="https://developer.mozilla.org/zh-CN/docs/Glossary/CORS" target="_blank" rel="noopener noreferrer">CORS<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>) 是一种机制，允许运行在一个 origin (domain) 上的浏览器，被准许访问不同源的服务器上的资源。
<ul><li><p>简单请求
限制在 请求方法为 get post head
限制请求头字段Accept、Accept-Language、Content-Language、Content-Type（只能是application/x-www-form-urlencoded, multipart/form-data, text/plain）
剩下的是复杂请求。
还会在请求中添加origin字段，返回的响应里Access-Control-allow-Origin来判断是否拦截该请求。
附带可选的请求头 withCredentials, 响应里Access-Control-allow-withCredentials。
Access-Control-Expose-Headers会给予客户端可以取到的请求头能力。</p></li> <li><p>复杂请求
由预检请求和参数请求组成，
预检请求格式：</p> <div class="language-html extra-class"><pre class="language-html"><code>  OPTIONS / HTTP/1.1
  Origin: 当前请求源
  Host: www.xxx.com
  Access-Control-Request-Method: PUT
  Access-Control-Request-Headers: FScut-Custom-Header
</code></pre></div><p>请求方法必定为option，会添加上Origin，Host，以及会附带上将要进行请求的特征，
Access-Control-Request-Method,Access-Control-Request-Headers,
询问是否允许。</p> <p>返回的响应里：</p> <div class="language- extra-class"><pre class="language-text"><code>  HTTP/1.1 200 OK
  Access-Control-Allow-Origin: *
  Access-Control-Allow-Methods: GET, POST, PUT
  Access-Control-Allow-Headers: FScut-Custom-Header
  Access-Control-Allow-Credentials: true
  Access-Control-Max-Age: 86400
  Content-Type: text/html; charset=utf-8
  Content-Encoding: gzip
  Content-Length: 0
</code></pre></div><p>会告知浏览器 允许请求的Origin,Methods,Headers,等</p></li></ul></li></ol> <p>JSONP方式：利用script标签，获取资源，但限制在于仅仅是获取，也就是get请求。</p> <p>Nginx反向代理：</p> <ol><li>正向代理：client请求某服务器，但没办法直接访问（被限制之类，比如largest 视频网站），需要借助中介去访问该服务器</li> <li>反向代理：client请求某资源，统一的来到某个服务器下，由他转发请求给具体的服务器，在返回结果给client</li></ol></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/Blog/network/TCP_UDP.html" class="prev">
        TCP
      </a></span> <span class="next"><a href="/Blog/network/网络安全.html">
        web安全
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/Blog/assets/js/app.a1114f8c.js" defer></script><script src="/Blog/assets/js/2.866c5de6.js" defer></script><script src="/Blog/assets/js/9.f7629a86.js" defer></script>
  </body>
</html>
