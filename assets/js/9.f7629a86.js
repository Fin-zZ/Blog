(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{370:function(t,e,a){t.exports=a.p+"assets/img/TLS.24221658.png"},399:function(t,e,a){"use strict";a.r(e);var n=a(25),s=Object(n.a)({},(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[n("h1",{attrs:{id:"https-http"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#https-http"}},[t._v("#")]),t._v(" https http")]),t._v(" "),n("p",[t._v("http:超文本传输协议")]),t._v(" "),n("ol",[n("li",[t._v("http特点\n"),n("ul",[n("li",[t._v("灵活，可以传输任意类型对象，通过content-type定义")]),t._v(" "),n("li",[t._v("无连接 每次连接只能处理一个请求，服务器处理完这次请求后，\n并受到客户端回应后，就断开连接，不利于客户端和服务端会话的保持，\n无法记录之前的状态，需要借助cookie session 记录用户")]),t._v(" "),n("li",[t._v("无状态，指的是对事物处理没有记忆，后续如果要处理之前的信息，\n则需要重传。")])])])]),t._v(" "),n("p",[t._v("缺点部分：")]),t._v(" "),n("ul",[n("li",[n("p",[t._v("http是明文传播，涉及到密码、个人信息等就不太安全。\n存在信息被篡改、被仿冒的可能。")])]),t._v(" "),n("li",[n("p",[t._v("无状态，无法记录相关联信息")])])]),t._v(" "),n("ol",{attrs:{start:"2"}},[n("li",[n("p",[t._v("URI: Uniform Resource Identifier 统一资源"),n("em",[t._v("标志")]),t._v("符\nURL: Uniform Resource Location 统一资源"),n("em",[t._v("定位")]),t._v("符\nURI: 具体描述某个资源的，可以通过URI知道该资源是什么，\nURL：用来定位具体资源的位置，以及访问该资源的方式")])]),t._v(" "),n("li",[n("p",[t._v("http报文组成")])])]),t._v(" "),n("h4",{attrs:{id:"请求报文"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#请求报文"}},[t._v("#")]),t._v(" 请求报文")]),t._v(" "),n("div",{staticClass:"language-http request extra-class"},[n("pre",{pre:!0,attrs:{class:"language-http"}},[n("code",[n("span",{pre:!0,attrs:{class:"token request-line"}},[n("span",{pre:!0,attrs:{class:"token property"}},[t._v("POST")]),t._v(" /api/v2/za/logs/batch HTTP/1.1")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token header-name keyword"}},[t._v("Host:")]),t._v(" zhihu-web-analytics.zhihu.com\n"),n("span",{pre:!0,attrs:{class:"token header-name keyword"}},[t._v("Connection:")]),t._v(" keep-alive\n"),n("span",{pre:!0,attrs:{class:"token header-name keyword"}},[t._v("Content-Length:")]),t._v(" 675\n"),n("span",{pre:!0,attrs:{class:"token header-name keyword"}},[t._v("sec-ch-ua:")]),t._v(' " Not;A Brand";v="99", "Google Chrome";v="91", "Chromium";v="91"\n'),n("span",{pre:!0,attrs:{class:"token header-name keyword"}},[t._v("X-ZA-ClientID:")]),t._v(" 35b5cc03-2b2d-4011-a794-3d51c1a12161\n"),n("span",{pre:!0,attrs:{class:"token header-name keyword"}},[t._v("Content-Encoding:")]),t._v(" gzip\n"),n("span",{pre:!0,attrs:{class:"token header-name keyword"}},[t._v("sec-ch-ua-mobile:")]),t._v(" ?0\n"),n("span",{pre:!0,attrs:{class:"token header-name keyword"}},[t._v("User-Agent:")]),t._v(" Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/91.0.4472.114 Safari/537.36\n"),n("span",{pre:!0,attrs:{class:"token header-name keyword"}},[t._v("Content-Type:")]),t._v(" application/x-protobuf\n"),n("span",{pre:!0,attrs:{class:"token header-name keyword"}},[t._v("X-ZA-Product:")]),t._v(" Zhihu\n"),n("span",{pre:!0,attrs:{class:"token header-name keyword"}},[t._v("X-ZA-Batch-Size:")]),t._v(" 6\n"),n("span",{pre:!0,attrs:{class:"token header-name keyword"}},[t._v("X-ZA-Log-Version:")]),t._v(" 3.1.51\n"),n("span",{pre:!0,attrs:{class:"token header-name keyword"}},[t._v("X-ZA-Platform:")]),t._v(" DesktopWeb\n"),n("span",{pre:!0,attrs:{class:"token header-name keyword"}},[t._v("Accept:")]),t._v(" */*\n"),n("span",{pre:!0,attrs:{class:"token header-name keyword"}},[t._v("Origin:")]),t._v(" https://zhuanlan.zhihu.com\n"),n("span",{pre:!0,attrs:{class:"token header-name keyword"}},[t._v("Sec-Fetch-Site:")]),t._v(" same-site\n"),n("span",{pre:!0,attrs:{class:"token header-name keyword"}},[t._v("Sec-Fetch-Mode:")]),t._v(" cors\n"),n("span",{pre:!0,attrs:{class:"token header-name keyword"}},[t._v("Sec-Fetch-Dest:")]),t._v(" empty\n"),n("span",{pre:!0,attrs:{class:"token header-name keyword"}},[t._v("Referer:")]),t._v(" https://zhuanlan.zhihu.com/p/72616216\n"),n("span",{pre:!0,attrs:{class:"token header-name keyword"}},[t._v("Accept-Encoding:")]),t._v(" gzip, deflate, br\n"),n("span",{pre:!0,attrs:{class:"token header-name keyword"}},[t._v("Accept-Language:")]),t._v(" zh-CN,zh;q=0.9,en;q=0.8\n")])])]),n("ol",[n("li",[t._v("请求方法 请求地址 协议/版本号")]),t._v(" "),n("li",[t._v("请求头")]),t._v(" "),n("li",[t._v("请求正文")])]),t._v(" "),n("h4",{attrs:{id:"响应报文的结构"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#响应报文的结构"}},[t._v("#")]),t._v(" 响应报文的结构")]),t._v(" "),n("div",{staticClass:"language-http request extra-class"},[n("pre",{pre:!0,attrs:{class:"language-http"}},[n("code",[n("span",{pre:!0,attrs:{class:"token response-status"}},[t._v("HTTP/1.1 "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v("200 OK")])]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token header-name keyword"}},[t._v("Date:")]),t._v(" Tue, 20 Jul 2021 04:28:26 GMT\n"),n("span",{pre:!0,attrs:{class:"token header-name keyword"}},[t._v("Content-Type:")]),t._v(" text/html; charset=UTF-8\n"),n("span",{pre:!0,attrs:{class:"token header-name keyword"}},[t._v("Content-Length:")]),t._v(" 0\n"),n("span",{pre:!0,attrs:{class:"token header-name keyword"}},[t._v("Connection:")]),t._v(" keep-alive\n"),n("span",{pre:!0,attrs:{class:"token header-name keyword"}},[t._v("Server:")]),t._v(" openresty\n"),n("span",{pre:!0,attrs:{class:"token header-name keyword"}},[t._v("Access-Control-Allow-Origin:")]),t._v(" *\n"),n("span",{pre:!0,attrs:{class:"token header-name keyword"}},[t._v("X-Backend-Response:")]),t._v(" 0.003\n")])])]),n("ol",[n("li",[t._v("协议/版本号")]),t._v(" "),n("li",[t._v("响应头")]),t._v(" "),n("li",[t._v("响应报文")])]),t._v(" "),n("h3",{attrs:{id:"post-get异同点"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#post-get异同点"}},[t._v("#")]),t._v(" post get异同点")]),t._v(" "),n("p",[t._v("相同：")]),t._v(" "),n("ul",[n("li",[t._v("都有请求行，请求头")]),t._v(" "),n("li")]),t._v(" "),n("p",[t._v("不同：")]),t._v(" "),n("ul",[n("li",[t._v("get请求的参数都在url上，有长度上限制，该限制由各个浏览器决定。\npost请求的参数可以在url上，但大多放到request body里，通过设置content-type类型，")]),t._v(" "),n("li",[t._v("post相对来说稍微安全些，毕竟参数不在url上")]),t._v(" "),n("li",[t._v("get请求具备等冥性，post不行；另外get请求的结果可被缓存下来。")]),t._v(" "),n("li",[t._v("get 本质是检索远程数据的，请求通常是 获取资源，\n并且不会对服务器数据进行修改； 具备等冥性\npost通常用于发送表单数据，账号密码等，会更新数据库/插入数据，")])]),t._v(" "),n("p",[t._v("响应的状态码\n1XX：信息型 服务器收到请求，要求客户端继续的\n2XX：成功型 请求收到，并成功返回；\n3XX：重定向类型，永久、临时、使用缓存等；\n4XX：客户端出差，无法访问等\n5XX：服务器出错。")]),t._v(" "),n("p",[t._v("常见的状态码：\n200: ok 成功返回\n301：永久重定向\n302: 临时重定向\n304: 资源未改变，使用缓存\n400: bad request\n403: forbidden\n404: not found\n503: 服务器暂时无法处理客户端请求.")]),t._v(" "),n("h2",{attrs:{id:"使用https"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#使用https"}},[t._v("#")]),t._v(" 使用https")]),t._v(" "),n("p",[t._v("https 一般认为是http + SSL/TLS协议\n设计目标：")]),t._v(" "),n("ol",[n("li",[t._v("数据的加密，保证数据被加密，无法被第三方查看。")]),t._v(" "),n("li",[t._v("数据的完整性，及时发现数据被第三方窜改过。")]),t._v(" "),n("li",[t._v("身份的校验，确保数据是所希望的地址")])]),t._v(" "),n("p",[t._v("相比于http的区别：")]),t._v(" "),n("ol",[n("li",[t._v("https需要使用ca证书验证身份，需要一定费用")]),t._v(" "),n("li",[t._v("使用的默认端口不一样，https443，http8080")]),t._v(" "),n("li",[t._v("http明文传输，https是加密信息的传输，相对安全\n改进的地方\n"),n("ol",[n("li",[t._v("双向的身份认证")]),t._v(" "),n("li",[t._v("数据加密")])])])]),t._v(" "),n("p",[t._v("缺点：")]),t._v(" "),n("ol",[n("li",[t._v("首次握手连接的消耗增加")]),t._v(" "),n("li",[t._v("ca证书需要的费用")]),t._v(" "),n("li",[t._v("数据加密以及解密带来的资源消耗")]),t._v(" "),n("li",[t._v("也只是安全了一定程度，如果ca证书链并不安全呢")])]),t._v(" "),n("p",[t._v("TLS协议使用了两种加密技术：对称加密和非对称加密\nTLS协议位于应用层之下，传输层上。")]),t._v(" "),n("p",[t._v("TLS利用非对称加密进行身份认证，密钥协商；对称加密进行信息加密以传输，基于散列函数验证数据的完整性。")]),t._v(" "),n("p",[t._v("服务器可以将公钥发送给各个客户端，客户端直接直接无法解密，但可以利用该公钥进行数据加密，服务器拿到后再利用私钥解密，\n即可实现一对多。问题的关键在于如何给客户端公钥。毕竟中途也可能如下图被拦截窜改。")]),t._v(" "),n("p",[n("img",{attrs:{src:a(370),alt:"TLS"}}),t._v("\n图片来自 https://tyler-zx.blog.csdn.net/article/details/107591115")]),t._v(" "),n("p",[t._v("解决方法之一是依靠中心化机构，有他们发布一些可信赖的证书，后续的认证下属证书\n才有层次的签名架构，以此下去，一个证书可能会含有1or多个根证书。\n一些知名的根证书通常随系统装好了")]),t._v(" "),n("h3",{attrs:{id:"http1-1"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#http1-1"}},[t._v("#")]),t._v(" http1.1")]),t._v(" "),n("p",[t._v("相比http1.0 解决了队首阻塞问题，\n当http开启长连接时，共用一个tcp连接，那么一次也就只能处理\n一个任务，存在阻塞问题。\n解决方案：")]),t._v(" "),n("ul",[n("li",[t._v("多个并发连接，chrome允许同时存在6个")]),t._v(" "),n("li",[t._v("利用多个子域名分散开请求。")])]),t._v(" "),n("p",[t._v("针对浏览器跨域问题：\n浏览器遵循同源策略，非同源站点存在一些限制")]),t._v(" "),n("ul",[n("li",[t._v("不可读取和修改对方站点的dom")]),t._v(" "),n("li",[t._v("不可读取对方cookie，LocalStorage, IndexDB")]),t._v(" "),n("li",[t._v("限制了XMLHTTPRequest请求。")])]),t._v(" "),n("p",[t._v("当一个资源从与该资源本身所在的服务器"),n("strong",[t._v("不同的域、协议或端口")]),t._v("请求一个资源时，资源会发起一个"),n("strong",[t._v("跨域 HTTP 请求")]),t._v("。")]),t._v(" "),n("table",[n("thead",[n("tr",[n("th",[t._v("URI")]),t._v(" "),n("th"),t._v(" "),n("th",[t._v("changeOrigin")])])]),t._v(" "),n("tbody",[n("tr",[n("td",[t._v("http://www.cnblogs.com/a.js  http://www.a.com/b.js")]),t._v(" "),n("td",[t._v("不同域名")]),t._v(" "),n("td",[t._v("是")])]),t._v(" "),n("tr",[n("td",[t._v("http://www.a.com/lab/a.js  http://www.a.com/script/b.js")]),t._v(" "),n("td",[t._v("同域名下不同文件")]),t._v(" "),n("td",[t._v("否")])]),t._v(" "),n("tr",[n("td",[t._v("http://www.a.com:8000/a.js  http://www.a.com/b.js")]),t._v(" "),n("td",[t._v("不同端口（port）")]),t._v(" "),n("td",[t._v("是")])]),t._v(" "),n("tr",[n("td",[t._v("http://www.a.com/a.js  https://www.a.com/b.js")]),t._v(" "),n("td",[t._v("同域名 不同协议")]),t._v(" "),n("td",[t._v("是")])])])]),t._v(" "),n("p",[t._v("解决方法：")]),t._v(" "),n("ol",[n("li",[t._v("跨域资源共享("),n("a",{attrs:{href:"https://developer.mozilla.org/zh-CN/docs/Glossary/CORS",target:"_blank",rel:"noopener noreferrer"}},[t._v("CORS"),n("OutboundLink")],1),t._v(") 是一种机制，允许运行在一个 origin (domain) 上的浏览器，被准许访问不同源的服务器上的资源。\n"),n("ul",[n("li",[n("p",[t._v("简单请求\n限制在 请求方法为 get post head\n限制请求头字段Accept、Accept-Language、Content-Language、Content-Type（只能是application/x-www-form-urlencoded, multipart/form-data, text/plain）\n剩下的是复杂请求。\n还会在请求中添加origin字段，返回的响应里Access-Control-allow-Origin来判断是否拦截该请求。\n附带可选的请求头 withCredentials, 响应里Access-Control-allow-withCredentials。\nAccess-Control-Expose-Headers会给予客户端可以取到的请求头能力。")])]),t._v(" "),n("li",[n("p",[t._v("复杂请求\n由预检请求和参数请求组成，\n预检请求格式：")]),t._v(" "),n("div",{staticClass:"language-html extra-class"},[n("pre",{pre:!0,attrs:{class:"language-html"}},[n("code",[t._v("  OPTIONS / HTTP/1.1\n  Origin: 当前请求源\n  Host: www.xxx.com\n  Access-Control-Request-Method: PUT\n  Access-Control-Request-Headers: FScut-Custom-Header\n")])])]),n("p",[t._v("请求方法必定为option，会添加上Origin，Host，以及会附带上将要进行请求的特征，\nAccess-Control-Request-Method,Access-Control-Request-Headers,\n询问是否允许。")]),t._v(" "),n("p",[t._v("返回的响应里：")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("  HTTP/1.1 200 OK\n  Access-Control-Allow-Origin: *\n  Access-Control-Allow-Methods: GET, POST, PUT\n  Access-Control-Allow-Headers: FScut-Custom-Header\n  Access-Control-Allow-Credentials: true\n  Access-Control-Max-Age: 86400\n  Content-Type: text/html; charset=utf-8\n  Content-Encoding: gzip\n  Content-Length: 0\n")])])]),n("p",[t._v("会告知浏览器 允许请求的Origin,Methods,Headers,等")])])])])]),t._v(" "),n("p",[t._v("JSONP方式：利用script标签，获取资源，但限制在于仅仅是获取，也就是get请求。")]),t._v(" "),n("p",[t._v("Nginx反向代理：")]),t._v(" "),n("ol",[n("li",[t._v("正向代理：client请求某服务器，但没办法直接访问（被限制之类，比如largest 视频网站），需要借助中介去访问该服务器")]),t._v(" "),n("li",[t._v("反向代理：client请求某资源，统一的来到某个服务器下，由他转发请求给具体的服务器，在返回结果给client")])])])}),[],!1,null,null,null);e.default=s.exports}}]);