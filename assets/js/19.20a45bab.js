(window.webpackJsonp=window.webpackJsonp||[]).push([[19],{387:function(t,s,a){"use strict";a.r(s);var e=a(25),n=Object(e.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"addeventlistener的passive参数作用"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#addeventlistener的passive参数作用"}},[t._v("#")]),t._v(" addEventListener的passive参数作用")]),t._v(" "),a("h2",{attrs:{id:"简介："}},[a("a",{staticClass:"header-anchor",attrs:{href:"#简介："}},[t._v("#")]),t._v(" 简介：")]),t._v(" "),a("p",[t._v("addEventListener有三个参数")]),t._v(" "),a("p",[t._v("target.addEventListener(event, handler, useCapture),第三个参数useCapture默认是false.")]),t._v(" "),a("p",[t._v("DOM事件(event flow)存在三个阶段：事件捕获阶段、处于目标阶段、事件冒泡阶段。")]),t._v(" "),a("p",[t._v("useCapture默认false即冒泡阶段。")]),t._v(" "),a("p",[t._v("但也可以是一个对象，")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("\tcapture: Boolean,\n\tonce: Boolean,\n\tpassive: Boolean,\n")])])]),a("p",[a("code",[t._v("once")]),t._v("表示"),a("code",[t._v("listener")]),t._v("在添加之后最多只调用一次。如果是"),a("code",[t._v("true")]),t._v("，"),a("code",[t._v("listener")]),t._v("会在其被调用之后自动移除，这跟我们在jQuery时代的"),a("code",[t._v("once")]),t._v("方法比较像。")]),t._v(" "),a("p",[a("code",[t._v("passive")]),t._v("表示"),a("code",[t._v("listener")]),t._v("永远不会调用"),a("code",[t._v("preventDefault()")]),t._v("。如果"),a("code",[t._v("listener")]),t._v("仍然调用了这个函数，客户端将会忽略它并抛出一个控制台警告。")]),t._v(" "),a("h2",{attrs:{id:"作用："}},[a("a",{staticClass:"header-anchor",attrs:{href:"#作用："}},[t._v("#")]),t._v(" 作用：")]),t._v(" "),a("p",[t._v("当我们在滚动页面的时候（通常是我们监听touch事件的时候），页面其实会有一个短暂的停顿（大概200ms），浏览器不知道我们是否要"),a("code",[t._v("preventDefault")]),t._v("，所以它需要一个延迟来检测。这就导致了我们的滑动显得比较卡顿。")]),t._v(" "),a("p",[t._v("从Chrome 51开始，"),a("code",[t._v("passive event listener")]),t._v("被引进了Chrome，我们可以通过对"),a("code",[t._v("addEventListener")]),t._v("的第三个参数设置"),a("code",[t._v("{ passive: true }")]),t._v("来避免浏览器检测这个我们是否有在touch事件的handler里调用"),a("code",[t._v("preventDefault")]),t._v("。在这个时候，如果我们依然调用了"),a("code",[t._v("preventDefault")]),t._v("，就会在控制台打印一个警告。告诉我们这个"),a("code",[t._v("preventDefault")]),t._v("会被忽略。")]),t._v(" "),a("p",[t._v("当我们给"),a("code",[t._v("addEventListener")]),t._v("的第三个参数设置了"),a("code",[t._v("{ passive: true }")]),t._v("，这个事件监听器就被称为"),a("strong",[t._v("passive event listener")]),t._v("。")]),t._v(" "),a("p",[t._v("从Chrome 56开始，如果我们给"),a("code",[t._v("document")]),t._v("绑定"),a("code",[t._v("touchmove")]),t._v("或者"),a("code",[t._v("touchstart")]),t._v("事件的监听器，这个"),a("code",[t._v("passive")]),t._v("是会被默认设置为"),a("code",[t._v("true")]),t._v("以提高性能，是一个可以在移动端这种更加重视性能优化的场景下。")]),t._v(" "),a("h2",{attrs:{id:"兼容性："}},[a("a",{staticClass:"header-anchor",attrs:{href:"#兼容性："}},[t._v("#")]),t._v(" 兼容性：")]),t._v(" "),a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" passiveSupported "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("try")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" options "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Object"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("defineProperty")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"passive"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("get")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      passiveSupported "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n  window"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("addEventListener")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"test"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" options"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("catch")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("err"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n")])])]),a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[t._v("someElement"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("addEventListener")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"mouseup"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" handleMouseUp"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" passiveSupported "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("?")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" passive"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("p",[t._v("https://juejin.im/post/5ad804c1f265da504547fe68")])])}),[],!1,null,null,null);s.default=n.exports}}]);